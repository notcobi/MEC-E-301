clc; clear; close all

data = [
    275.6135751
    267.9164051
    276.5870479
    279.6576959
    263.1109358
    265.8191525
    222.8680378
    229.2626754
    210.8231427
    230.8343341
    203.5495954
    227.9429572
    172.9317676
    218.1861757
    229.7788819
    262.4045129
    261.2556241
    294.2182273
    245.1113593
    314.3868832
    324.8240836
    391.411095
    379.3589917
    403.7189098
    385.1639308
    393.0764788
    501.6918705
    487.2204723
    460.2832197
    596.9076107
    362.7931391
    446.9372398
    529.8248378
    610.1954915
    447.8216021
    434.540099
    204.6794386
    317.7757124
    353.1275291
    368.4194821
    262.0364563
    320.2240849
    -363.8394797
    243.6521739
    99.06604784
    253.167781
    -25.50290929
    180.6756495
    104.6864163
    132.5737164
    0
    134.4450335
    -107.2540921
    134.8235166
    0
    81.73371763
    -27.27015421
    82.19679791
    -109.0811002
    81.96482172
    0
    55.00489389
    -54.90120889
    55.00489389
    -136.4801301
    54.54035669
    0
    54.84946402
    -81.964822
    54.6946192
    -162.549511
    81.27410937
    -54.13181613
    81.50348154
    -81.27410964
    81.50348154
    -188.2243733
    80.59113605
    -26.8888182
    53.92907525
    -80.59113632
    80.81794064
    -133.8173723
    53.4765959
    0
    53.77768355
    -26.8888182
    81.04559708
    -160.7316269
    80.36517933
    0
    81.04559708
    -53.97966546
    108.5694612
    -134.9499954
    81.04559708
    0
    81.73371763
    -27.27015421
    82.19679791
    -136.0954366
    81.73371763
    0
    82.4296503
    -54.90120889
    82.66338305
    -136.8662749
    54.6946192
    27.45058001
    27.52839265
    -54.90120889
    55.00489389
    -136.4801301
    81.96482172
    -27.34728535
    54.84946402
    -81.964822
    54.6946192
    -162.549511
    81.27410937
    -27.11675992
    27.1422456
    -54.13181613
    54.23356766
    -161.1835463
    80.59113605
    -26.8888182
    53.92907525
    -80.59113632
    80.81794064
    -133.8173723
    80.36517933
    -26.81340553
    53.77768355
    -53.67707049
    80.81794064
    -107.2540921
    80.59113605
    -26.8888182
    108.2640134
    -81.04559735
    108.5694612
    -134.9499954
    81.04559708
    27.1422456
    54.54035669
    -27.27015421
    82.19679791
    -136.0954366
    81.73371763
    27.37306036
    55.00489389
    -54.90120889
    82.66338305
    -163.9309541
    109.492727
    -27.42470765
    55.00489389
    -54.90120889
    55.00489389
    -136.4801301
    54.54035669
    0
    54.84946402
    -81.964822
    54.6946192
    -162.549511
    54.08103573
    0
    27.1422456
    -54.13181613
    54.23356766
    -161.1835463
    53.62685798
    0
    53.92907525
    -80.59113632
    80.81794064
    -133.8173723
    107.3545167
    -26.8888182
    53.92907525
    -53.82808447
    81.04559708
    -134.1935002
    80.59113605
    0
    81.27410937
    -54.13181613
    81.50348154
    -108.1624529
    81.27410937
    -27.11675992
    109.1838126
    -54.59171305
    82.19679791
    -136.0954366
    81.73371763
    27.37306036
    55.00489389
    -54.90120889
    55.00489389
    -136.4801301
    109.492727
    -27.42470765
    55.00489389
    -54.90120889
    55.00489389
    -136.4801301
    54.54035669
    -27.27015421
    82.19679791
    -109.0811002
    54.54035669
    -135.330376
    54.08103573
    -27.04049407
    54.23356766
    -54.13181613
    54.23356766
    -161.1835463
    53.62685798
    -26.81340553
    80.81794064
    -80.59113632
    80.81794064
    -133.8173723
    53.4765959
    0
    80.81794064
    -80.59113632
    107.9597102
    -134.1935002
    80.59113605
    0
    81.27410937
    -54.13181613
    108.8760591
    -135.330376
    81.27410937
    0
    81.96482172
    -54.59171305
    82.19679791
    -136.0954366
    109.1838126
    0
    55.00489389
    -54.90120889
    82.66338305
    -136.8662749
    54.6946192
    0
    55.00489389
    -54.90120889
    55.00489389
    -136.4801301
    54.54035669
    -27.27015421
    54.6946192
    -54.59171305
    54.6946192
    -189.2861293
    53.92907525
    0
    27.0658842
    -53.97966546
    54.08103573
    -134.1935002
    53.62685798
    0
    53.92907525
    -80.59113632
    80.81794064
    -133.8173723
    80.36517933
    -26.81340553
    53.77768355
    -53.67707049
    107.9597102
    -107.555745
    80.81794064
    -26.96451394
    108.5694612
    -54.28453915
    81.73371763
    -135.330376
    81.27410937
    27.21889452
    54.6946192
    -27.34728535
    82.4296503
    -136.4801301
    54.54035669
    27.37306036
    55.00489389
    -54.90120889
    82.66338305
    -136.8662749    
].';

% apply FFT
N = length(data);
T = 1525296/10^6; % sampling period

data_fft = fft(data)*T/N;

% low pass filter with derivative
f = 150; % cutoff frequency
omega = 1:length(data_fft);
H = 1./(1 + 1i*omega/f); % transfer function

% apply filter
data_fft_filtered = data_fft .* H;

%plot frequency spectrum
figure(1)
plot(abs(data_fft))
hold on
plot(abs(data_fft_filtered))
legend('original', 'filtered')


% apply inverse FFT
data_filtered = ifft(data_fft_filtered);

% plot
figure(2)
plot(data)
hold on
plot(data_filtered)
legend('original', 'filtered')


